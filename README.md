# LLM-Based TLS Certificate Phishing Detection

Detects phishing TLS certificates using LLM semantic analysis (local Llama 3.1 or cloud Gemini).


## ğŸ¯ Key Features

- **Pure LLM-Based Detection**: No rules, no regex, no statistical thresholds
- **Semantic Anomaly Detection**: Identifies unnatural domain patterns, organizational mismatches, and linguistic inconsistencies
- **Comprehensive Analysis**: Detailed metrics, visualizations, and misclassification reports
- **Free Tier Compatible**: Designed to work with Gemini's free API tier
- **Production Ready**: Batch processing, error handling, rate limiting, and progress tracking

## ğŸ—ï¸ Architecture
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Certificate    â”‚
â”‚  Files (ASCII)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Certificate    â”‚
â”‚  Loader         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Gemini API     â”‚
â”‚  (Semantic      â”‚
â”‚   Analysis)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Structured     â”‚
â”‚  Predictions    â”‚
â”‚  (JSONâ†’CSV)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Performance    â”‚
â”‚  Analysis &     â”‚
â”‚  Visualization  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Prerequisites

- Python 3.8+
- **One of:** Local Ollama ([install](https://ollama.ai/)) or Gemini API key ([get free](https://ai.google.dev/))
- Certificate dataset (not included)

## Installation

```bash
# Clone
git clone https://github.com/MuhammadDanishGH/cert-llm-detector.git
cd cert-llm-detector

# Install dependencies
pip install -r requirements.txt

# Setup LLM (choose one)
# Option A: Local
curl -fsSL https://ollama.ai/install.sh | sh
ollama pull llama3.1:8b

# Option B: Cloud
# Get API key from https://ai.google.dev/

# Configure
cp .env.example .env
# Edit .env: Set LLM_MODE (local/cloud/auto) and credentials
```

## Dataset Structure

```
certificates/
â”œâ”€â”€ phishing-certificates/      # Raw dataset
â”œâ”€â”€ benign-certificates/        # Raw dataset
â””â”€â”€ selected-subset/            # Generated by sampler.py
    â”œâ”€â”€ phishing-certificates/
    â””â”€â”€ benign-certificates/
```

## Usage

### 1. Generate Subset (Required)

```bash
python sampler.py certificates/
# Creates certificates/selected-subset/ with sampled data
```

### 2. Run Detection

```bash
python main.py certificates/
# Outputs: results/predictions.csv
```

### 3. Analyze Results

```bash
python analysis.py results/
# Outputs: results/analysis/report.txt + plots/
```

## Configuration

Edit `.env` for key settings:

```bash
# LLM
LLM_MODE=auto                    # local, cloud, or auto
LOCAL_MODEL=llama3.1:8b
GEMINI_API_KEY=your-key

# Sampling
SAMPLE_SIZE_PER_CLASS=3000       # Samples per class
SAMPLING_METHOD=random           # random, stratified, or first
RANDOM_SEED=42

# Performance
CERTS_PER_API_CALL=5             # Batch size
MAX_CONCURRENT_REQUESTS=2        # Parallel requests
```

See `.env.example` for all options.

## Troubleshooting

```bash
# Subset missing
python sampler.py certificates/

# Ollama not running
ollama serve
ollama pull llama3.1:8b

# Regenerate subset
python sampler.py certificates/ --force

# Resume interrupted run
python main.py certificates/  # Auto-resumes from checkpoint
```

## License

MIT License
